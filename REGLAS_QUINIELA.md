# 📋 REGLAS OFICIALES DE LA QUINIELA ESPAÑOLA

## 🏛️ **Marco Regulatorio**
- **Normativa**: Resolución BOE-A-1998-17040 del 6 de julio de 1998
- **Organismo**: Organismo Nacional de Loterías y Apuestas del Estado
- **Actualización**: Resolución del 6 de julio de 2009 (regulaciones actuales)

---

## 💰 **Estructura de Precios y Premios**

### **Precio Base**
- **Apuesta Simple**: €0.75 por pronóstico
- **Apuesta Mínima**: €1.50 (2 pronósticos o 1 con doble)
- **Distribución de Ingresos**: 55% a premios, 45% gestión y reservas

### **Categorías de Premios**
1. **Primera Categoría (15 aciertos)**: Máximo premio
2. **Segunda Categoría (14 aciertos)**: Segundo premio  
3. **Tercera Categoría (13 aciertos)**: Tercer premio
4. **Categoría Especial (10% reservado)**: Botes y premios especiales

---

## 🎯 **Tipos de Pronósticos**

### **Pronósticos Básicos**
- **"1"**: Victoria del equipo local
- **"X"**: Empate
- **"2"**: Victoria del equipo visitante

### **Pronósticos Múltiples**
- **Simple**: 1 pronóstico por partido (precio base €0.75)
- **Doble**: 2 pronósticos por partido (precio x2 = €1.50)
- **Triple**: 3 pronósticos por partido (precio x3 = €2.25)

---

## 🔄 **Sistemas de Apuestas Múltiples**

### **1. Método Directo**
**Descripción**: Combinaciones libres hasta el máximo permitido
- **Mínimo**: 2 apuestas
- **Máximo**: 31,104 apuestas por boleto
- **Flexibilidad**: Total libertad de combinaciones

### **2. Método Reducido** ⭐ **MÁS POPULAR**
**Descripción**: Combinaciones predefinidas que optimizan cobertura/precio

#### **Reducciones Oficiales Disponibles:**

**🥇 Primera Reducción**
- **Configuración**: 4 triples
- **Combinaciones**: 81 apuestas (3⁴)
- **Precio**: €60.75 (81 × €0.75)
- **Ideal para**: Máxima cobertura con presupuesto medio

**🥈 Segunda Reducción**
- **Configuración**: 7 dobles
- **Combinaciones**: 128 apuestas (2⁷)
- **Precio**: €96.00 (128 × €0.75)
- **Ideal para**: Equilibrio entre riesgo y cobertura

**🥉 Tercera Reducción**
- **Configuración**: 3 dobles + 3 triples
- **Combinaciones**: 216 apuestas (2³ × 3³)
- **Precio**: €162.00 (216 × €0.75)
- **Ideal para**: Estrategia mixta avanzada

**🏅 Cuarta Reducción**
- **Configuración**: 6 dobles + 2 triples
- **Combinaciones**: 576 apuestas (2⁶ × 3²)
- **Precio**: €432.00 (576 × €0.75)
- **Ideal para**: Profesionales con alta confianza

**🎖️ Quinta Reducción**
- **Configuración**: 8 triples
- **Combinaciones**: 6,561 apuestas (3⁸)
- **Precio**: €4,920.75 (6,561 × €0.75)
- **Ideal para**: Sistemas profesionales/sindicatos

**🏆 Sexta Reducción**
- **Configuración**: 11 dobles
- **Combinaciones**: 2,048 apuestas (2¹¹)
- **Precio**: €1,536.00 (2,048 × €0.75)
- **Ideal para**: Cobertura masiva conservadora

### **3. Método Condicional**
**Descripción**: Apuestas condicionadas a resultados específicos
- **Uso**: Avanzado, para expertos
- **Flexibilidad**: Máxima personalización
- **Complejidad**: Requiere conocimientos profundos

---

## 🎮 **ELIGE 8 - Juego Complementario**

### **¿Qué es Elige 8?**
Juego complementario asociado a la Quiniela donde seleccionas 8 pronósticos específicos de tu boleto principal.

### **Reglas de Elige 8**
- **Requisito**: Obligatorio jugar Quiniela principal
- **Selección**: Elegir 8 partidos de los 15 de tu Quiniela
- **Precio**: €0.50 por apuesta Elige 8
- **Precio Mínimo Total**: €2.00 (€1.50 Quiniela + €0.50 Elige 8)

### **Sistema de Premios Elige 8**
- **Fondo Independiente**: 55% del dinero recaudado específico de Elige 8
- **Categoría Única**: Solo se premia acertar los 8 resultados
- **Sin Botes**: No se acumulan premios no repartidos
- **Distribución**: 100% del fondo para acertantes de 8

---

## 🔢 **Cálculos de Combinaciones**

### **Fórmula General**
```
Total Combinaciones = ∏(i=1 a 15) [Multiplicidad_i]
```

Donde:
- **Multiplicidad_i** = 1 (simple), 2 (doble), 3 (triple)

### **Ejemplos Prácticos**

**Ejemplo 1: Reducción Simple**
- 13 simples + 2 dobles = 1¹³ × 2² = 1 × 4 = **4 apuestas**
- Precio: 4 × €0.75 = **€3.00**

**Ejemplo 2: Reducción Media**
- 10 simples + 3 dobles + 2 triples = 1¹⁰ × 2³ × 3² = 1 × 8 × 9 = **72 apuestas**
- Precio: 72 × €0.75 = **€54.00**

**Ejemplo 3: Reducción Avanzada**
- 5 simples + 5 dobles + 5 triples = 1⁵ × 2⁵ × 3⁵ = 1 × 32 × 243 = **7,776 apuestas**
- Precio: 7,776 × €0.75 = **€5,832.00**

---

## 📊 **Estrategias Recomendadas**

### **🔰 Principiante**
- **Estrategia**: 13-14 simples + 1-2 dobles
- **Inversión**: €3.00 - €6.00
- **Riesgo**: Bajo
- **Cobertura**: Limitada pero económica

### **🎯 Intermedio**
- **Estrategia**: 10-12 simples + 2-3 dobles + 1-2 triples
- **Inversión**: €20.00 - €100.00
- **Riesgo**: Medio
- **Cobertura**: Equilibrada

### **💎 Avanzado**
- **Estrategia**: Reducciones oficiales (1ª-3ª)
- **Inversión**: €60.00 - €200.00
- **Riesgo**: Alto
- **Cobertura**: Máxima precisión

### **🏆 Profesional**
- **Estrategia**: Reducciones masivas (4ª-6ª) + Elige 8
- **Inversión**: €400.00 - €5,000.00
- **Riesgo**: Muy alto
- **Cobertura**: Completa

---

## 🛠️ **Implementación Técnica**

### **Campos de Base de Datos Requeridos**
```sql
-- Tabla principal de quinielas
ALTER TABLE user_quinielas ADD COLUMN:
- bet_type VARCHAR(20) DEFAULT 'simple'  -- 'simple', 'multiple', 'reduced'
- total_combinations INTEGER DEFAULT 1
- total_cost DECIMAL(10,2) DEFAULT 0.75
- elige_8_enabled BOOLEAN DEFAULT FALSE
- elige_8_matches JSON                    -- IDs de 8 partidos seleccionados
- elige_8_cost DECIMAL(5,2) DEFAULT 0.00

-- Tabla de pronósticos individuales
ALTER TABLE user_quiniela_predictions ADD COLUMN:
- multiplicity INTEGER DEFAULT 1         -- 1=simple, 2=doble, 3=triple
- prediction_options JSON                 -- ["1"], ["1","X"], ["1","X","2"]
```

### **Lógica de Validación**
```python
def validate_quiniela_bet(predictions, elige_8_matches=None):
    """Validar apuesta de quiniela según reglas oficiales"""
    
    # Validar 15 partidos
    if len(predictions) != 15:
        raise ValueError("Quiniela debe tener exactamente 15 partidos")
    
    # Calcular combinaciones totales
    total_combinations = 1
    for pred in predictions:
        multiplicity = len(pred.prediction_options)
        if multiplicity not in [1, 2, 3]:
            raise ValueError("Multiplicidad debe ser 1, 2 o 3")
        total_combinations *= multiplicity
    
    # Validar límites
    if total_combinations < 2:
        raise ValueError("Mínimo 2 apuestas requeridas")
    if total_combinations > 31104:
        raise ValueError("Máximo 31,104 apuestas permitidas")
    
    # Validar Elige 8
    if elige_8_matches:
        if len(elige_8_matches) != 8:
            raise ValueError("Elige 8 requiere exactamente 8 partidos")
        if not all(match_id in [p.match_id for p in predictions] for match_id in elige_8_matches):
            raise ValueError("Partidos Elige 8 deben estar en Quiniela principal")
    
    # Calcular costo
    base_cost = total_combinations * 0.75
    elige_8_cost = 0.50 if elige_8_matches else 0.00
    total_cost = base_cost + elige_8_cost
    
    # Validar costo mínimo
    if total_cost < 1.50:
        raise ValueError("Apuesta mínima €1.50")
    
    return {
        'valid': True,
        'total_combinations': total_combinations,
        'base_cost': base_cost,
        'elige_8_cost': elige_8_cost,
        'total_cost': total_cost
    }
```

---

## 📱 **Interfaz de Usuario Recomendada**

### **Selector de Modalidad**
1. **🎯 Simple**: Pronóstico único por partido
2. **⚡ Múltiple**: Dobles y triples libres
3. **🏆 Reducida**: Sistemas oficiales predefinidos
4. **🎮 + Elige 8**: Cualquier modalidad + Elige 8

### **Controles por Partido**
- **Radio buttons**: Para simples (1, X, 2)
- **Checkboxes**: Para múltiples (combinaciones)
- **Indicador visual**: Multiplicidad y costo en tiempo real

### **Panel de Resumen**
- **Combinaciones totales**: Cálculo automático
- **Costo base**: €X.XX
- **Costo Elige 8**: €0.50 (si activo)
- **Total**: €X.XX
- **Ganancia potencial**: Estimación basada en categorías

---

**✅ SISTEMA LISTO PARA IMPLEMENTACIÓN**

*Documentación basada en normativa oficial BOE y reglamentos de Loterías y Apuestas del Estado*